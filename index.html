<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=1280" />
		<meta name="robots" content="noindex, nofollow" />
		<title>Decade - Still loading</title>
		<link rel="icon" href="Decade/assets/sprites/heart.png" type="image/png" />

		<!-- Pixel Font -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

		<!-- CSS: Reset & Base -->
		<link rel="stylesheet" href="Decade/css/reset.css" />
		<link rel="stylesheet" href="Decade/css/base.css" />
		<link rel="stylesheet" href="Decade/css/layout.css" />

		<!-- CSS: Components -->
		<link rel="stylesheet" href="Decade/css/components/hud.css" />
		<link rel="stylesheet" href="Decade/css/components/timeline.css" />
		<link rel="stylesheet" href="Decade/css/components/overlay.css" />
		<link rel="stylesheet" href="Decade/css/components/canvas.css" />
		<link rel="stylesheet" href="Decade/css/components/controller.css" />

		<!-- CSS: Era Themes -->
		<link rel="stylesheet" href="Decade/css/themes/era-snes.css" />
		<link rel="stylesheet" href="Decade/css/themes/era-n64.css" />
		<link rel="stylesheet" href="Decade/css/themes/era-ps2.css" />
	</head>

	<!-- 
    Era classes: 
    - era-snes (Levels 1-4)
    - era-n64  (Levels 5-7) 
    - era-ps2  (Levels 8-10)
-->
	<body class="era-snes">
		<script>
			if (!sessionStorage.getItem("decade_auth")) {
				window.location.replace("login.html");
			}
		</script>

		<!-- =====================================================
         APP: viewport + controller (controller hidden on desktop)
         ===================================================== -->
		<div id="app">
			<div id="viewport">
				<div id="game-container">
					<!-- HUD: Top bar with level info, score, etc. -->
					<header id="hud" class="hud" role="banner">
						<div class="hud__section hud__section--left">
							<span class="hud__label">LEVEL</span>
							<span class="hud__value" id="hud-level">01</span>
							<span class="hud__year" id="hud-year">2016</span>
						</div>

						<div class="hud__section hud__section--center">
							<h1 class="hud__title" id="hud-title">DECADE</h1>
						</div>

						<div class="hud__section hud__section--right">
							<span class="hud__label">SCORE</span>
							<span class="hud__value" id="hud-score">0000</span>
						</div>
					</header>

					<!-- MAIN GAME AREA -->
					<main id="game-area" class="game-area" role="main">
						<!-- Canvas container for mini-games -->
						<div id="canvas-container" class="canvas-container">
							<canvas id="game-canvas" width="960" height="540"></canvas>

							<!-- Scanline overlay for retro effect -->
							<div class="canvas-scanlines" aria-hidden="true"></div>
						</div>
					</main>

					<!-- TIMELINE: Bottom navigation with level nodes -->
					<nav id="timeline" class="timeline" role="navigation" aria-label="Level timeline">
						<div class="timeline__track">
							<!-- Timeline nodes will be generated by JS -->
							<!-- Structure for each node:
                <button class="timeline__node timeline__node--completed" data-level="1">
                    <span class="timeline__node-year">2016</span>
                    <span class="timeline__node-dot"></span>
                </button>
                -->
						</div>
						<div class="timeline__progress" id="timeline-progress"></div>
					</nav>
				</div>
				<!-- Mobile virtual controller (overlay; positioned via CSS) -->
				<div id="virtual-controller" class="vc-overlay vc-overlay--hidden" aria-hidden="true"></div>
			</div>
		</div>

		<!-- =====================================================
         ROTATE OVERLAY (mobile portrait gate)
         ===================================================== -->
		<div id="rotate-overlay" class="rotate-overlay hidden" aria-hidden="true">
			<div class="rotate-card">
				<div class="rotate-icon" aria-hidden="true"></div>
				<h2>Rotate your phone</h2>
				<p>This game is best in landscape.</p>
				<button id="rotate-try" class="overlay__button overlay__button--primary" type="button">
					Tap to continue
				</button>
			</div>
		</div>

		<!-- =====================================================
         OVERLAY SYSTEM (Modals, Reveals, Menus)
         ===================================================== -->
		<div id="overlay-system" class="overlay-system" aria-hidden="true">
			<!-- Generic overlay backdrop -->
			<div class="overlay__backdrop" id="overlay-backdrop"></div>

			<!-- OVERLAY: Level Complete -->
			<div
				id="overlay-level-complete"
				class="overlay overlay--level-complete"
				role="dialog"
				aria-modal="true"
				aria-labelledby="overlay-complete-title"
			>
				<div class="overlay__content">
					<h2 class="overlay__title" id="overlay-complete-title">LEVEL COMPLETE!</h2>
					<div class="overlay__stats">
						<div class="overlay__stat">
							<span class="overlay__stat-label">SCORE</span>
							<span class="overlay__stat-value" id="complete-score">0000</span>
						</div>
						<div class="overlay__stat">
							<span class="overlay__stat-label">TIME</span>
							<span class="overlay__stat-value" id="complete-time">00:00</span>
						</div>
					</div>
					<button class="overlay__button overlay__button--primary" id="btn-continue">CONTINUE</button>
				</div>
			</div>

			<!-- OVERLAY: Restart Confirm (Timeline navigation) -->
			<div
				id="overlay-restart-confirm"
				class="overlay overlay--level-complete"
				role="dialog"
				aria-modal="true"
				aria-labelledby="overlay-restart-title"
			>
				<div class="overlay__content">
					<h2 class="overlay__title" id="overlay-restart-title">RESTART LEVEL?</h2>
					<div class="overlay__stats">
						<div class="overlay__stat">
							<span class="overlay__stat-label">LEVEL</span>
							<span class="overlay__stat-value" id="restart-level-label">1</span>
						</div>
						<div class="overlay__stat">
							<span class="overlay__stat-label">YEAR</span>
							<span class="overlay__stat-value" id="restart-year-label">2016</span>
						</div>
					</div>
					<p style="margin: 10px 0 14px; font-size: 12px; opacity: 0.9; text-align: center">
						Restarting will clear the collectible for this level.
					</p>
					<div style="display: flex; gap: 10px; justify-content: center">
						<button class="overlay__button overlay__button--primary" id="btn-restart-confirm" type="button">
							RESTART
						</button>
						<button class="overlay__button" id="btn-restart-cancel" type="button">CANCEL</button>
					</div>
				</div>
			</div>

			<!-- OVERLAY: Memory Reveal (Post-level romantic content) -->
			<div id="overlay-memory-reveal" class="overlay overlay--memory-reveal" role="dialog" aria-modal="true">
				<div class="overlay__content overlay__content--reveal">
					<div class="reveal__media" id="reveal-media">
						<!-- Image/content loaded dynamically -->
					</div>
					<div class="reveal__text">
						<h2 class="reveal__year" id="reveal-year">2016</h2>
						<p class="reveal__message" id="reveal-message">
							<!-- Memory text loaded dynamically -->
						</p>
					</div>
					<button class="overlay__button overlay__button--primary" id="btn-next-level">NEXT CHAPTER</button>
				</div>
			</div>

			<!-- OVERLAY: Pause Menu -->
			<div id="overlay-pause" class="overlay overlay--pause" role="dialog" aria-modal="true">
				<div class="overlay__content">
					<h2 class="overlay__title">PAUSED</h2>
					<nav class="overlay__menu">
						<button class="overlay__button" id="btn-resume">RESUME</button>
						<button class="overlay__button" id="btn-restart-level">RESTART LEVEL</button>
						<button class="overlay__button" id="btn-scores">SCORES</button>
						<button class="overlay__button" id="btn-main-menu">MAIN MENU</button>
					</nav>
				</div>
			</div>

			<!-- OVERLAY: Name Entry (arcade style, after game complete) -->
			<div
				id="overlay-name-entry"
				class="overlay overlay--name-entry overlay--name-entry-with-scores"
				role="dialog"
				aria-modal="true"
			>
				<div class="overlay__content overlay__content--name-entry">
					<h2 class="overlay__title">ENTER YOUR NAME</h2>
					<p class="overlay__hint">3–10 chars · A–Z, 0–9, _ · No duplicates</p>
					<div class="name-entry__field">
						<input
							type="text"
							id="name-entry-input"
							class="name-entry__input"
							maxlength="10"
							placeholder="___"
							autocomplete="off"
							autocapitalize="characters"
							spellcheck="false"
						/>
					</div>
					<div class="name-entry__scores">
						<h3 class="name-entry__scores-title">HIGH SCORES</h3>
						<div class="scores-table-wrap scores-table-wrap--compact">
							<div class="scores-loader" id="name-entry-scores-loader" hidden>
								<span>LOADING</span>
								<span class="scores-loader__dots" aria-hidden="true">
									<span class="scores-loader__dot"></span>
									<span class="scores-loader__dot"></span>
									<span class="scores-loader__dot"></span>
								</span>
							</div>
							<table class="scores-table">
								<thead>
									<tr>
										<th>#</th>
										<th>NAME</th>
										<th>SCORE</th>
										<th>ITEMS</th>
									</tr>
								</thead>
								<tbody id="name-entry-scores-body"></tbody>
							</table>
						</div>
					</div>
					<p class="overlay__error" id="name-entry-error" hidden>Scores unavailable offline</p>
					<button type="button" class="overlay__button" id="btn-skip-score" style="display: none">
						CONTINUE WITHOUT SAVING
					</button>
				</div>
			</div>

			<!-- OVERLAY: Scores / Leaderboard -->
			<div id="overlay-scores" class="overlay overlay--scores" role="dialog" aria-modal="true">
				<div class="overlay__content overlay__content--scores">
					<h2 class="overlay__title">HIGH SCORES</h2>
					<div class="scores-table-wrap">
						<div class="scores-loader" id="scores-loader" hidden>
							<span>LOADING</span>
							<span class="scores-loader__dots" aria-hidden="true">
								<span class="scores-loader__dot"></span>
								<span class="scores-loader__dot"></span>
								<span class="scores-loader__dot"></span>
							</span>
						</div>
						<table class="scores-table">
							<thead>
								<tr>
									<th>RANK</th>
									<th>NAME</th>
									<th>SCORE</th>
									<th>ITEMS</th>
								</tr>
							</thead>
							<tbody id="scores-table-body">
								<!-- Populated by JS -->
							</tbody>
						</table>
					</div>
					<p class="scores-error" id="scores-error" hidden>Scores unavailable offline</p>
					<button class="overlay__button" id="btn-scores-close">CLOSE</button>
				</div>
			</div>

			<!-- OVERLAY: Webcam Finale (after Level 10 complete) -->
			<div
				id="overlay-webcam-finale"
				class="overlay overlay--webcam"
				role="dialog"
				aria-modal="true"
				aria-labelledby="webcam-finale-title"
			>
				<div class="overlay__content webcam-card">
					<h2 class="overlay__title" id="webcam-finale-title">After 10 years…</h2>
					<p class="webcam-subtitle">This is the present.</p>
					<div class="webcam-frame">
						<video id="webcamVideo" autoplay playsinline muted></video>
						<div class="webcam-scanlines" aria-hidden="true"></div>
					</div>
					<div class="webcam-actions">
						<button type="button" class="overlay__button overlay__button--primary" id="btn-play-again">
							PLAY AGAIN
						</button>
						<button
							type="button"
							class="overlay__button webcam-retry-btn"
							id="btn-retry-camera"
							style="display: none"
						>
							TRY CAMERA AGAIN
						</button>
					</div>
					<p class="webcam-note" id="webcamStatus"></p>
				</div>
			</div>

			<!-- OVERLAY: Title Screen -->
			<div id="overlay-title" class="overlay overlay--title overlay--visible" role="dialog" aria-modal="true">
				<div class="overlay__content overlay__content--title">
					<div class="title__logo">
						<h1 class="title__main">DECADE</h1>
						<p class="title__sub">2016 — 2026</p>
						<p class="title__tagline">Ten years. Ten memories. One story.</p>
					</div>
					<button class="overlay__button overlay__button--start" id="btn-start">PRESS START</button>
					<p class="title__hint">Or press SPACE / ENTER</p>
				</div>
			</div>
		</div>

		<!-- =====================================================
         JAVASCRIPT MODULES
         ===================================================== -->

		<!-- Core modules -->
		<script src="Decade/js/core/event-bus.js"></script>
		<script src="Decade/js/core/input.js"></script>
		<script src="Decade/js/core/storage.js"></script>
		<script src="Decade/js/core/state-manager.js"></script>
		<script src="Decade/js/core/scores-api.js"></script>
		<script src="Decade/js/core/level-manager.js"></script>

		<!-- Engine -->
		<script src="Decade/js/engine/canvas-renderer.js"></script>
		<script src="Decade/js/engine/game-loader.js"></script>

		<!-- UI Controllers -->
		<script src="Decade/js/ui/hud-controller.js"></script>
		<script src="Decade/js/ui/timeline-controller.js"></script>
		<script src="Decade/js/ui/timeline-sprite-controller.js"></script>
		<script src="Decade/js/ui/overlay-controller.js"></script>
		<script src="Decade/js/ui/virtual-controller.js"></script>

		<!-- Level configuration -->
		<script src="Decade/js/levels/level-config.js"></script>

		<!-- App initialization (must be last) -->
		<script src="Decade/js/app.js"></script>
	</body>
</html>
